<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.care.mybatis.Mapper">
<!-- 회원가입 수정 -->
<update id="updatedata" parameterType="com.care.DTO.MemberDTO">
	update member set
	 pw=#{pw},
	 name=#{name},
	 email=#{email},
	 tel=#{tel},
	 addr=#{addr},
	 pw_answer=#{pw_answer}
	 where id=#{id}
</update>

<!-- 상품등록  -->
<insert id="saveproduct" parameterType="com.care.DTO.ProductnameDTO">
		
		insert into productname values(
		#{product_name_no},
		#{product_category_no},
		#{product_name_title},
		#{product_name_detail},
		#{product_name_price},
		#{product_name_image},
		#{product_thumbnail},
		#{product_stock},
		#{product_hit},
		#{product_hashtag}
		)
	
</insert>
	<!-- 노트북상품목록 전체 검색 -->
	<select id="NotebooklistAll" resultType="com.care.DTO.ProductnameDTO" >
		select * from productname where product_category_no = 'notebook'
	</select>
	
	<!-- 컴퓨터상품목록 전체 검색 -->
	<select id="ComputerlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'computer'
	</select>
	
	<!-- 모니터상품목록 전체 검색 -->
	<select id="MoniterlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'moniter'
	</select>
	
	<!-- 마우스상품목록 전체 검색 -->
	<select id="MouselistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'mouse'
	</select>
	
	<!-- 스피커상품목록 전체 검색 -->
	<select id="SpeakerlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'speaker'
	</select>
	
	<!-- 그래픽카드상품목록 전체 검색 -->
	<select id="GraphiccardlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'graphiccard'
	</select>
	
	<!-- cpu상품목록 전체 검색 -->
	<select id="CpulistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'cpu'
	</select>
	
	<!-- 메인보드상품목록 전체 검색 -->
	<select id="MainboardlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'mainboard'
	</select>
	
	<!-- 하드디스크상품목록 전체 검색 -->
	<select id="HddlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'hdd'
	</select>
	
	<!-- SDD상품목록 전체 검색 -->
	<select id="SddlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'sdd'
	</select>
	
	<!-- RAM상품목록 전체 검색 -->
	<select id="RamlistAll" resultType="com.care.DTO.ProductnameDTO">
		select * from productname where product_category_no = 'ram'
	</select>
	
	<!-- 상품 상세보기 -->
	<select id="Productlist" resultType="com.care.DTO.ProductnameDTO" parameterType="String">
		select * from productname where product_name_no=#{product_name_no}
	</select>
	
	<!-- 수정할 상품 고유번호보기 -->
	<select id="Modifylist" resultType="com.care.DTO.ProductnameDTO" parameterType="String" >
		select product_name_no from productname where product_name_no=#{product_name_no}
	</select>
	
		<!-- 상품수정  -->
	<update id="modifysaveproduct" parameterType="com.care.DTO.ProductnameDTO">
		update  productname 
			set
		product_category_no =#{product_category_no},
		product_name_title =#{product_name_title},
		product_name_detail =#{product_name_detail},
		product_name_price =#{product_name_price},
		product_name_image =#{product_name_image},
		product_thumbnail =#{product_thumbnail},
		product_stock =#{product_stock},
		product_hashtag =#{product_hashtag}
		where product_name_no = #{product_name_no}
</update>

<!-- 상품삭제 -->
<delete id="deleteproduct" parameterType="String">
		delete from productname where product_name_no = #{product_name_no}
	</delete>
	
	<!-- 장바구니등록  -->	
<insert id="saveshoppingcart" parameterType="com.care.DTO.ShoppingCartDTO">
		
		insert into shoppingcart values(
			#{id},
			#{product_name_image},
			#{product_name_title},
			#{product_name_price},
			#{product_count}
		)
		</insert>
		
<!-- 장바구니 상세보기 -->
	<select id="viewshoppingcart" resultType="com.care.DTO.ShoppingCartDTO" parameterType="String">
		select * from shoppingcart where id=#{user_id}
	</select>

<!-- 창훈 게시판 -->
	
	<!-- 게시판 글쓰기 -->
	<insert id="savedata" >
		INSERT INTO BOARD_QA(QA_CATEGORY , USER_ID , QA_CONTENT , QA_LOGTIME , QA_PWD , QA_REPLY , QA_SEQ , QA_STATE , QA_SUBJECT) 
		VALUES(#{qa_category},#{user_id},#{qa_content},sysdate,#{qa_pwd,jdbcType=VARCHAR},0,qa_seq.nextval,#{qa_state},#{qa_subject})
	</insert>
	<!-- 게시판 목록 페이징 -->
	<select id="listPage" resultType="com.care.DTO.Board_qaDTO" parameterType="com.care.DTO.Board_qaCriteria">
		SELECT  QA_SEQ, 
            QA_CATEGORY,
		        QA_SUBJECT, 
		        USER_ID, 
		        QA_LOGTIME
		 FROM ( 
		        SELECT QA_SEQ,
		               QA_CATEGORY, 
		               QA_SUBJECT, 
		               USER_ID, 
		               QA_LOGTIME, 
		               ROW_NUMBER() OVER(ORDER BY QA_SEQ DESC) AS RNUM
		         FROM BOARD_QA
		         WHERE 1=1
		         	<include refid="search"></include>
		                       ) MP
		WHERE RNUM BETWEEN #{rowStart} AND #{rowEnd}
		ORDER BY QA_SEQ DESC
	</select>
	<!-- 게시판 총 개수 -->
	<select id="listCount" resultType="int">
		SELECT COUNT(QA_SEQ)
		  FROM BOARD_QA
		  WHERE 1=1
		  <include refid="search"></include>
		 AND QA_SEQ > 0
	</select>
	
	<!-- 게시판 검색 -->
	<sql id="search">
		<if test="searchType != null">
			<if test="searchType == 't'.toString()">AND QA_SUBJECT LIKE '%' || #{keyword} || '%'</if>
			<if test="searchType == 'c'.toString()">AND QA_CONTENT LIKE '%' || #{keyword} || '%'</if>
			<if test="searchType == 'w'.toString()">AND USER_ID LIKE '%' || #{keyword} || '%'</if>
			<if test="searchType == 'tc'.toString()">AND (QA_SUBJECT LIKE '%' || #{keyword} || '%') or (QA_CONTENT LIKE '%' || #{keyword} || '%')</if>
		</if>
	</sql>
	
	<!-- 게시판 조회 -->
	<select id="read" parameterType="int" resultType="com.care.DTO.Board_qaDTO">
		SELECT	QA_SEQ
			  , QA_CATEGORY
			  , QA_PWD
			  , QA_CONTENT
			  , QA_SUBJECT
			  , USER_ID
			  , QA_LOGTIME
			  , QA_STATE
		 FROM BOARD_QA
		 WHERE qa_seq = #{qa_seq}
	</select>
	<!-- 수정 -->
	<update id="update" parameterType="com.care.DTO.Board_qaDTO">
		UPDATE BOARD_QA
		   SET QA_CATEGORY=#{qa_category},
		   	   QA_SUBJECT= #{qa_subject},
		   	   QA_CONTENT= #{qa_content},
		   	   QA_PWD=#{qa_pwd},
		   	   QA_LOGTIME=sysdate
		 WHERE qa_seq = #{qa_seq}
	</update>
	<!-- 삭제 -->
	<delete id="delete" parameterType="int">
		DELETE 
		  FROM BOARD_QA
		 WHERE qa_seq = #{qa_seq}
	</delete>
	
	<!-- 댓글 조회 -->
	<select id="readReply" resultType="com.care.DTO.Board_qaReplyDTO">
    	SELECT
    		  qa_reply_seq, content, userid, logtime
    	 FROM qa_reply
    	WHERE qa_seq = #{qa_seq}
	</select>
</mapper>














